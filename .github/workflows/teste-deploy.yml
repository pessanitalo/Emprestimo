name: Deploy CI/CD
on:
  push:
    branches:
      - main # executa os testes na branch main
jobs:
  run-tests:
    runs-on: ubuntu-latest

    steps:
     - name: Checkout
       uses: actions/checkout@v4

     - name: setup node
       uses: actions/setup-node@v4
       with:
        node-version: 20

     - name: Install dependencias
       run: npm ci
       working-directory: Emprestimoapp

     - name: Build app
       run: npm run build
       working-directory: Emprestimoapp

     - name: Upload artifacts
       uses: actions/upload-artifact@v4
       with:
        name: build-site
        path: Emprestimoapp/dist/

  deploy:
    needs: [run-tests] ## s√≥ inicia o deploy se run-tests der sucesso
    runs-on: ubuntu-latest

    steps:
     - name: Checkout
       uses: actions/checkout@v4

     - name: Build app
       run: echo "Building app"

     - name: Deploy to stage
       run: echo "Deploy to stage" 
